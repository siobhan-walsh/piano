<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<title>piano</title>
</head>
<style>
#keysw{
	width:100%;
	height:350px;
	background-color:#8C5703;
	position:absolute;
	bottom:0px;
}

.but{
	width:12%;
	margin:0px;
	height:100%;
	background:#FFFFFF;
}
#keysb{
	width:90%;
	height:350px;
	position:absolute;
	bottom:200px;
}
.but2{
	width:10%;
	margin:20px;
	height:100%;
	background:#000;
}
.but3{
	float:right;
	width:10%;
	margin-right:40px;
	height:100%;
	background:#000;
}
</style>
<body>
<div id="play">

	<input type="button" id="pb"value='play'>
    
</div>
<div id="keysw">
 <input class="but pnote" id='c' type='button' value='c'/>
 <input class="but pnote" id='d' type='button' value='d'/>
 <input class="but pnote" id='e' type='button' value='e'/>
 <input class="but pnote" id='f' type='button' value='f'/>
 <input class="but pnote" id='g' type='button' value='g'/>
 <input class="but pnote" id='a' type='button' value='a'/>
 <input class="but pnote" id='b' type='button' value='b'/>
 <!--<input class="but" id='8' type='button' value='8'/>-->

</div>
<div id="keysb">
 <input class="but2 pnote" id='cs' type='button' value='c#'/>
 <input class="but2 pnote" id='ds' type='button' value='d#'/>
 <input class="but3 pnote" id='as' type='button' value='a#'/>
 <input class="but3 pnote" id='gs' type='button' value='g#'/>
 <input class="but3 pnote" id='fs' type='button' value='f#'/>
</div>

    
    <audio id="note">
	   <source id= 'source' src="sounds/f.wav" type="audio/wav" data-note="0">
    </audio>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script>
$(document).ready(function(){
		
		var arr = [];
		var num = 1;
        var notes = document.querySelectorAll('.pnote');
        var thesource = document.getElementById('source');

        for(var i = 0; i < notes.length; i++){
           
            notes[i].addEventListener('click', blindClick(i));
                
           
        }

                  function blindClick(i){
    
                    return function(){
                        var thething = this;
                
                        $("#note")[0].pause();

                       $.when(changeit()).then(playit());

                        function changeit(){

                         

                            document.getElementById('source').src = "sounds/" + thething.id + ".wav";
                            arr.push(thething.id);
                         
                        };

                        function playit(){
                         

                            $('#note').load();
                            $('#note')[0].play();
                        };

                        console.log('arr is', arr);

                    }

            }
   /* 
   
		$("#1").click( 
			function(){
				$("#c")[0].play();
				arr.push("#c");
				console.log("arr", arr);
			}
		);
		
		
		$("#9").click( 
			function(){
				$("#cs")[0].play();
				arr.push("#cs");
				console.log("arr", arr);
			}
 		);
        
       
		
		$("#pb").click( 
			function(){
				var i;
				for(i = 0; i < arr.length;i++){;
				$(arr[i])[0].play();
				console.log("arr", arr);
				
				} 
			}
		);
	
		 
		
		$("#pb").click(function (event) {
		   
			  
			  
			  for(i = 0; i < arr.length;i++){
                  
                  
               // thesource.src = "sounds/" + arr[i] + ".wav";
                
				//$('#note')[0].play();
				console.log("arr", arr);
                  
                    
                var audioSub = $('#note').get(0); 
                var playmode=audioSub.paused;  
                  
                     
                    thesource.src = "sounds/" + arr[i] + ".wav";
             
                    audioSub.play();
                  
                  $('#note').on('playing', function() {
                       playing = true;
                      audioSub.play();
                       // disable button/link
                    });
                    $('#note').on('ended', function() {
                       playing = false;
                       // enable button/link
                    });
               
               
                  
                  
              }
        });
		*/		
    
    $("#pb").click(function (event) {
        var x = 0;

        var loopArray = function(arrr) {
            // call itself
            customAlert(arrr[x],function(){
                // set x to next item
                x++;
                // any more items in array?
                if(x < arrr.length) {
                    loopArray(arrr);   
                }
            }); 
        }

        // start 'loop'
        loopArray(arr);

        function customAlert(msg, callback) {
            // fancy code to show your message
            
                
			
            console.log(msg);
            // do callback when ready
            
            function doit(){
                thesource.src = "sounds/" + arr[x] + ".wav";
                $('#note').load();
                $('#note')[0].play()
                
            };
            callback(doit());
        }
    });
    
                  /*
				if(!playing) {
                  var element = $(arr[1]);
                  var elementID = event.target.id;
                  var oggVar = (elementID +".ogg");   
                  var audioElement = $('#c')[0];
                  var audioElement = $('#cs')[0];
                  audioElement.setAttribute('src', oggVar); 
                  audioElement.play();
                  console.log("lhfaskldjf");

                  var playing = false;

                $('#note').on('playing', function() {
                   playing = true;
                   // disable button/link
                });
                $('#note').on('ended', function() {
                   playing = false;
                   // enable button/link
                });
				
				} 
		   }

});
*/
		//function() {
			
					
				
		//}
		//$("#pb").click);
				
		
		
		
		
  });

</script>
</body>
</html>
